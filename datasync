#!/usr/bin/env python3

import subprocess as sub
import os

# list of directories having git repository
gitdirs = [
"/home/codeman/mydata/git/bin-git",
"/home/codeman/mydata/git/configs-git",
"/home/codeman/mydata/git/mynotes-git",
"/home/codeman/mydata/git/research/misc-git",
"/home/codeman/mydata/git/research/meetings-git",
"/home/codeman/mydata/git/research/resources-git",
"/home/codeman/mydata/git/research/code/benchmarks-git",
"/home/codeman/mydata/git/research/code/cs618project-git",
"/home/codeman/mydata/git/research/writeups/mandar-report-git",
"/home/codeman/mydata/git/research/writeups/mywriteups-git",
"/home/codeman/mydata/git/research/writeups/research-notes-git",
"/home/codeman/mydata/git/research/writeups/cs618-project-report-git",
"/home/codeman/mydata/git/ws/gate-notes-git",
"/home/codeman/mydata/git/ws/web-filebrowser-git",
"/home/codeman/mydata/git/ws/web-organizer-git",
]

gitcommands = [
"""git add --all""",
"""git commit -m 'automated-update'""",
"""git fetch origin master""",
"""git merge -m "automated-merge" origin/master""",
"""git push origin master""",
]

def syncall():
    err = 0
    for dir in gitdirs:
        print(os.linesep, "$>>> ", dir, os.linesep, sep="")

        try:
            os.chdir(dir)
        except FileNotFoundError as e:
            print("DIRECTORY NOT FOUND")
            err += 1
            continue

        for cmd in gitcommands:
            cp = sub.run(cmd, shell=True)
            err += cp.returncode


if __name__ == "__main__":
  print("STARTING PYTHON SCRIPT", os.linesep)
  err = syncall()
  if err:
      print(os.linesep, "*****FINISHED WITH ERRORS*****", os.linesep, sep="")
  else:
      print(os.linesep, "SUCCESS.", os.linesep, sep="")


